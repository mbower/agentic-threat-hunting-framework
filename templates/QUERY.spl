/* H-#### | [Hunt Title]
   ATT&CK: T#### - [Technique Name]
   Purpose: [Brief description of what this query detects]
   Time Range: [Earliest] to [Latest]
   Result Cap: 1000
   Owner: [Your name]
   Created: YYYY-MM-DD
   Last Modified: YYYY-MM-DD by [Name]
*/

index=[your_index] sourcetype=[your_sourcetype]
[additional filters based on your hypothesis]
earliest=[time] latest=now

| stats count as [metric_name],
        dc([field]) as [distinct_count_name],
        values([field]) as [list_values],
        earliest(_time) as first_seen,
        latest(_time) as last_seen
        by [key_field1], [key_field2]

| where [threshold condition - e.g., count > 10]

| eval duration=last_seen-first_seen
| eval [calculated_field]=round([formula], 2)

| sort - [metric_name]
| head 1000

| eval hunt_id="H-####", attack_technique="T####"

/* Query Notes:
   - Expected runtime: [X seconds on Y days of data]
   - Expected false positives: [Brief description]
   - Exclude known-good patterns: [Add filters as learned from past runs]

   Example FP Filters (uncomment as needed):
   | search NOT (src_ip="10.*" OR src_ip="172.16.*" OR src_ip="192.168.*")
   | where user NOT IN ("system", "admin", "service_account")
*/
