# H-0001 | SSH Brute Force Detection

**Status**: Active (Recurring Hunt)

## Hypothesis

Adversaries use automated tools to attempt SSH authentication against Linux servers, generating patterns of failed login attempts that indicate brute force activity.

## Context

**Why Now:** SOC alert #2847 detected SSH login anomalies over weekend. Need to validate detection threshold and identify if any brute force attempts targeting real accounts.

**ATT&CK Mapping:**
- **Technique:** T1110.001 - Brute Force: Password Guessing
- **Tactic:** TA0006 - Credential Access
- **Sub-technique:** Password guessing via SSH

**Related Past Hunts:**
- None - this is the first SSH brute force hunt

## Data Needed

**Primary Data Source:**
- **Index/Source:** `linux_secure` (Linux authentication logs)
- **Key Fields:** `src_ip`, `dest_host`, `user`, `action`, `_time`
- **Expected Volume:** ~8,000 failed auth events per day
- **Retention:** 90 days

**Secondary Data Sources (if needed):**
- User account inventory (to distinguish real accounts from default/test credentials)
- Known scanner IP lists (for baseline noise filtering)

**Telemetry Gaps:**
- Dev and CI/CD environments lack centralized auth logging
- No geographic IP enrichment (would help identify anomalous locations)

## Time Range

**Initial Hunt Window:**
- **Earliest:** `-24h`
- **Latest:** `now`
- **Result Cap:** `1000`

**Rationale:** 24-hour window balances recent threat detection with manageable result volume. Weekend alert suggests active scanning - daily checks appropriate.

## Query Approach

**High-Level Logic:**
1. Filter to linux_secure index, failed SSH authentication events
2. Aggregate by source IP and destination host
3. Count failed attempts, unique usernames targeted, and time range
4. Calculate attempt rate (attempts per minute)
5. Apply threshold: >5 failed attempts (initial run, expect noise)
6. Exclude internal IP ranges (10.x, 172.16.x, 192.168.x)
7. Sort by failed attempt count descending

**Query File:** `queries/H-0001.spl`

**Expected False Positives:**
- Automated internet scanners (low attempt rate, default credentials)
- Legitimate users with password typos (internal IPs, followed by success)
- Known pentesting/vuln scanning tools (if approved scanning in progress)

**Performance Considerations:**
- Expected runtime: <5 seconds on 24h window
- Minimal SIEM impact (simple stats query, single index)

## Success Criteria

**Hunt is successful if:**
- Query runs within acceptable time (<10 seconds for 24h window)
- Results distinguish automated scanners from targeted attacks
- Findings lead to blocked IPs, detection rule, or documented baseline

**Hypothesis is validated if:**
- We identify >0 source IPs conducting sustained brute force attempts (>10 attempts, >1 minute duration)
- At least one attempt targets real user accounts (not just default credentials)

---

## Execution Instructions

**To run this hunt:**

1. **Copy this file:**
   ```bash
   cp hunts/H-0001.md hunts/H-0001_$(date +%Y-%m-%d).md
   ```

2. **Execute query and document findings in dated file**

3. **Keep this hypothesis file unchanged for future runs**

**For AI-assisted hunting:**
- Ask your AI: "Execute hunt H-0001" or "Run SSH brute force hunt"
- AI will read this file, run queries, and populate the execution report

**Past Execution Notes:**
- 2025-10-22: Initial run, found 1 confirmed brute force (IP: 203.0.113.45), threshold too low
- 2025-10-29: Refined query (threshold >10, exclude internal IPs), 75% noise reduction

**Query Refinements Applied:**
- Increased threshold from >5 to >10 failed attempts
- Added filter: Exclude internal IP ranges (10.x, 172.16.x, 192.168.x)
- Future: Add temporal logic for "newly seen in 7 days" source IPs
